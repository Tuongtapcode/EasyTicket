{% extends 'layout/base.html' %}
{% block title %}ƒêƒÉng k√Ω t√†i kho·∫£n{% endblock %}

{% block content %}
<style>
  .auth-wrap {
    min-height: calc(100vh - 120px);
    display: grid;
    place-items: center;
    background: radial-gradient(1200px 600px at 100% 0%, #f1f5ff 0%, transparent 60%),
                radial-gradient(1200px 600px at 0% 100%, #f8fcff 0%, transparent 60%);
  }
  .auth-card {
    border: 0;
    border-radius: 1.25rem;
    box-shadow: 0 10px 30px rgba(16,24,40,.08);
  }
  .auth-card .card-header {
    border: 0;
    background: linear-gradient(135deg, #3b82f6, #6366f1);
    color: #fff;
    border-radius: 1.25rem 1.25rem 0 0;
    padding: 1.5rem 1.5rem 1.25rem;
  }
  .brand-badge {
    display: inline-flex; align-items: center; gap: .5rem;
    background: rgba(255,255,255,.15); padding: .35rem .75rem;
    border-radius: 999px; font-size: .85rem;
  }
  .form-floating > label { color: #667085; }
  .input-icon-btn {
    position: absolute; right: .75rem; top: 50%; transform: translateY(-50%);
    border: 0; background: transparent; padding: .25rem .5rem; opacity: .75;
  }
  .input-icon-btn:hover { opacity: 1; }
</style>

<div class="auth-wrap">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-6 col-xl-5">
        <div class="card auth-card">
          <div class="card-header">
            <div class="brand-badge">
              <!-- B·∫°n c√≥ th·ªÉ thay b·∫±ng logo -->
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 3l9 6-9 6-9-6 9-6zm0 9l9 6-9 6-9-6" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
              <span>Easy Ticket</span>
            </div>
            <h2 class="h4 mt-3 mb-0">T·∫°o t√†i kho·∫£n m·ªõi</h2>
            <p class="mb-0" style="opacity:.9">ƒêi·ªÅn th√¥ng tin b√™n d∆∞·ªõi ƒë·ªÉ b·∫Øt ƒë·∫ßu.</p>
          </div>

          <div class="card-body p-4 p-md-5">
            <form method="POST" action="" novalidate id="register-form">
              {{ form.hidden_tag() }}

              <div class="row g-3">
                <div class="col-md-6 position-relative">
                  <div class="form-floating">
                    {{ form.first_name(class="form-control" + (" is-invalid" if form.first_name.errors else ""), placeholder="H·ªç") }}
                    <label>{{ form.first_name.label.text }}</label>
                    {% if form.first_name.errors %}
                      <div class="invalid-feedback">
                        {% for error in form.first_name.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>

                <div class="col-md-6 position-relative">
                  <div class="form-floating">
                    {{ form.last_name(class="form-control" + (" is-invalid" if form.last_name.errors else ""), placeholder="T√™n") }}
                    <label>{{ form.last_name.label.text }}</label>
                    {% if form.last_name.errors %}
                      <div class="invalid-feedback">
                        {% for error in form.last_name.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>

                <div class="col-12">
                  <div class="form-floating">
                    {{ form.username(class="form-control" + (" is-invalid" if form.username.errors else ""), placeholder="T√™n ƒëƒÉng nh·∫≠p") }}
                    <label>{{ form.username.label.text }}</label>
                    {% if form.username.errors %}
                      <div class="invalid-feedback">
                        {% for error in form.username.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>

                <div class="col-12">
                  <div class="form-floating">
                    {{ form.email(class="form-control" + (" is-invalid" if form.email.errors else ""), placeholder="Email") }}
                    <label>{{ form.email.label.text }}</label>
                    {% if form.email.errors %}
                      <div class="invalid-feedback">
                        {% for error in form.email.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>

                <div class="col-12">
                  <div class="form-floating">
                    {{ form.phone(class="form-control" + (" is-invalid" if form.phone.errors else ""), placeholder="S·ªë ƒëi·ªán tho·∫°i") }}
                    <label>{{ form.phone.label.text }}</label>
                    {% if form.phone.errors %}
                      <div class="invalid-feedback">
                        {% for error in form.phone.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>

                <div class="col-12 position-relative">
                  <div class="form-floating">
                    {{ form.password(class="form-control" + (" is-invalid" if form.password.errors else ""), placeholder="M·∫≠t kh·∫©u", id="password") }}
                    <label>{{ form.password.label.text }}</label>
                    <button type="button" class="input-icon-btn" tabindex="-1" aria-label="Hi·ªán/·∫©n m·∫≠t kh·∫©u" onclick="togglePwd('password', this)">
                      <span data-eye="on">üëÅÔ∏è</span>
                    </button>
                    {% if form.password.errors %}
                      <div class="invalid-feedback">
                        {% for error in form.password.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>

                <div class="col-12 position-relative">
                  <div class="form-floating">
                    {{ form.confirm_password(class="form-control" + (" is-invalid" if form.confirm_password.errors else ""), placeholder="X√°c nh·∫≠n m·∫≠t kh·∫©u", id="confirm_password") }}
                    <label>{{ form.confirm_password.label.text }}</label>
                    <button type="button" class="input-icon-btn" tabindex="-1" aria-label="Hi·ªán/·∫©n m·∫≠t kh·∫©u" onclick="togglePwd('confirm_password', this)">
                      <span data-eye="on">üëÅÔ∏è</span>
                    </button>
                    {% if form.confirm_password.errors %}
                      <div class="invalid-feedback">
                        {% for error in form.confirm_password.errors %}{{ error }}{% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>
              </div>

              <div class="d-grid mt-4">
                {{ form.submit(class="btn btn-primary btn-lg", id="submit-btn") }}
                <div class="form-text text-center mt-2">
                  Khi ƒëƒÉng k√Ω, b·∫°n ƒë·ªìng √Ω v·ªõi <a href="#">ƒêi·ªÅu kho·∫£n</a> & <a href="#">Ch√≠nh s√°ch</a> c·ªßa ch√∫ng t√¥i.
                </div>
              </div>
            </form>
          </div>

          <div class="card-footer bg-white border-0 text-center py-3">
            <small>ƒê√£ c√≥ t√†i kho·∫£n?
              <a href="{{ url_for('auth.register') }}">ƒêƒÉng nh·∫≠p</a>
            </small>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function togglePwd(id, btn) {
    const input = document.getElementById(id);
    if (!input) return;
    input.type = input.type === 'password' ? 'text' : 'password';
    const span = btn.querySelector('[data-eye]');
    if (span) span.textContent = input.type === 'password' ? 'üëÅÔ∏è' : 'üôà';
  }

  // Hi·ªáu ·ª©ng ƒëang g·ª≠i (kh√¥ng ƒë·ªïi logic backend)
  const form = document.getElementById('register-form');
  const submitBtn = document.getElementById('submit-btn');
  if (form && submitBtn) {
    form.addEventListener('submit', function () {
      submitBtn.disabled = true;
      const original = submitBtn.innerHTML;
      submitBtn.setAttribute('data-original', original);
      submitBtn.innerHTML =
        '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>ƒêang t·∫°o t√†i kho·∫£n...';
    });

    // N·∫øu c√≥ l·ªói tr·∫£ v·ªÅ server, n√∫t s·∫Ω render l·∫°i t·ª´ server => kh√¥ng c·∫ßn b·∫≠t l·∫°i b·∫±ng JS.
  }
</script>
{% endblock %}